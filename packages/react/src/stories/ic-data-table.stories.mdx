import {
  Meta,
  Story,
  Canvas,
  ArgsTable,
  Description,
} from "@storybook/addon-docs";
import { IcDataTable, IcButton } from "../components";
import { useState } from "react";
import readme from "../../../web-components/src/components/ic-data-table/readme.md";
import { useRef } from "react";
import {
  COLS,
  DATA,
  LONG_DATA,
  LONG_COLS,
  ROW_HEADER_COLS,
  ROW_HEADER_DATA,
  COLS_ALIGNMENT,
  ROW_ALIGNMENT,
  DATA_CELL_ALIGNMENT,
  COLS_ELEMENTS,
} from "../../../web-components/src/components/ic-data-table/story-data";

<Meta
  title="React Components/Data Table"
  component={IcDataTable}
  parameters={{
    componentAPI: {
      data: readme,
    },
  }}
/>

# [Canary]: Data Table

Use the data table component to display data in a tabular form.

There are two required props for data table:

- Caption: `string`
- Columns: `IcDataTableColumnObject[]`

Click the 'Component API' tab to view all the available props, events and slots for Data Tables.

To import the data table web component into your application, import `@ukic/canary-react` into your application.

### Basic

A basic example with no functionality.

<Canvas withSource="none">
  <Story name="Basic">
    <IcDataTable caption="Basic" columns={COLS} data={DATA} />
  </Story>
</Canvas>

#### Basic code example

```jsx
import * as React from "react";
import { IcDataTable } from "@ukic/react";
import { IcDataTableColumnObject } from "@ukic/web-components";

const columns: IcDataTableColumnObject[] = [
  {
    key: "firstName",
    title: "First name",
    dataType: "string",
  },
  {
    key: "lastName",
    title: "Last name",
    dataType: "string",
  },
  {
    key: "age",
    title: "Age",
    dataType: "number",
  },
  {
    key: "jobTitle",
    title: "Job title",
    dataType: "string",
  },
  {
    key: "address",
    title: "Address",
    dataType: "address",
  },
];

const data = [
  {
    firstName: "Joe",
    lastName: "Bloggs",
    age: 30,
    jobTitle: "Developer",
    address: "1 Main Street, Town, County, Postcode",
  },
  {
    firstName: "Sarah",
    lastName: "Smith",
    age: 28,
    jobTitle: "Analyst",
    address: "2 Main Street, Town, Country, Postcode",
  },
  {
    firstName: "Mark",
    lastName: "Owens",
    age: 45,
    jobTitle: "Team Lead",
    address: "12 Key Street, Town, Country, Postcode",
  },
  {
    firstName: "Naomi",
    lastName: "Thomas",
    age: 32,
    jobTitle: "Developer",
    address: "8 Side Street, Town, Country, Postcode",
  },
  {
    firstName: "Luke",
    lastName: "Ashford",
    age: 18,
    jobTitle: "Junior Developer",
    address: "5 New Street, Town, Country, Postcode",
  },
];

const DataTable = () => (
  <IcDataTable caption="Basic" columns={columns} data={data} />
);

export default DataTable;
```

### Embedded

The `embedded` boolean adds a border around the table so it can be added as a standalone table and is not required to stretch the full width of its parent container.

<Canvas withSource="none">
  <Story name="Embedded">
    <IcDataTable caption="Embedded" columns={COLS} data={DATA} embedded />
  </Story>
</Canvas>

#### Embedded code example

```jsx
import * as React from "react";
import { IcDataTable } from "@ukic/react";
import { IcDataTableColumnObject } from "@ukic/web-components";

// Copy columns array for 'basic' example
const columns: IcDataTableColumnObject[] = [
  {
    key: "firstName",
    title: "First name",
    dataType: "string",
  },
  ...
];

// Copy data array for 'basic' example
const data = [
  {
    firstName: "Joe",
    lastName: "Bloggs",
    age: 30,
    jobTitle: "Developer",
    address: "1 Main Street, Town, County, Postcode",
  },
  ...
];

const DataTable = () => (
  <IcDataTable caption="Embedded" columns={columns} data={data} embedded />
);

export default DataTable;
```

## Density

The `density` variant provides three different styles for the data table.

- `dense` reduces the padding and font size of the table cells to give the data a more dense style.
- `default` provides a padding of `8px` which is the default spacing. This variant is seen in the first [basic](#basic) example.
- `spacious` gives the data table a more spacious look and feel by increasing the vertical padding as well as the font size.

### Dense

<Canvas withSource="none">
  <Story name="Dense">
    <IcDataTable caption="Dense" columns={COLS} data={DATA} density="dense" />
  </Story>
</Canvas>

```jsx
import * as React from "react";
import { IcDataTable } from "@ukic/react";
import { IcDataTableColumnObject } from "@ukic/web-components";

// Copy columns array for 'basic' example
const columns: IcDataTableColumnObject[] = [
  {
    key: "firstName",
    title: "First name",
    dataType: "string",
  },
  ...
];

// Copy data array for 'basic' example
const data = [
  {
    firstName: "Joe",
    lastName: "Bloggs",
    age: 30,
    jobTitle: "Developer",
    address: "1 Main Street, Town, County, Postcode",
  },
  ...
];

const DataTable = () => (
  <IcDataTable
    caption="Dense"
    columns={columns}
    data={data}
    density="dense"
  />
);

export default DataTable;
```

### Spacious

<Canvas withSource="none">
  <Story name="Spacious">
    <IcDataTable
      caption="Dense"
      columns={COLS}
      data={DATA}
      density="spacious"
    />
  </Story>
</Canvas>

#### Spacious code example

```jsx
import * as React from "react";
import { IcDataTable } from "@ukic/react";
import { IcDataTableColumnObject } from "@ukic/web-components";

// Copy columns array for 'basic' example
const columns: IcDataTableColumnObject[] = [
  {
    key: "firstName",
    title: "First name",
    dataType: "string",
  },
  ...
];

// Copy data array for 'basic' example
const data = [
  {
    firstName: "Joe",
    lastName: "Bloggs",
    age: 30,
    jobTitle: "Developer",
    address: "1 Main Street, Town, County, Postcode",
  },
  ...
];

const DataTable = () => (
  <IcDataTable
    caption="Spacious"
    columns={columns}
    data={data}
    density="spacious"
  />
);

export default DataTable;
```

### Sticky column headers

export const StickyHeader = () => {
  const [stickyHeader, setStickyHeader] = useState(false);
  return (
    <>
      <IcDataTable
        caption="Sticky Header"
        columns={COLS}
        data={LONG_DATA}
        stickyColumnHeaders={stickyHeader}
        style={{ height: "366px" }}
      />
      <div style={{ display: "flex", gap: "8px", marginTop: "8px" }}>
        <IcButton onClick={() => setStickyHeader(true)}>Stick Header</IcButton>
        <IcButton onClick={() => setStickyHeader(false)}>
          Unstick Header
        </IcButton>
      </div>
    </>
  );
};

When a height for the data table is set, the scroll bar will appear to the right. However, by default, the column headers will move up and out of view making it difficult to understand what the data means.
This can be mitigated by using the `stickyColumnHeaders` prop which takes a boolean. This can be toggled within the example below.

<Canvas withSource="none">
  <Story name="Sticky Column Headers">
    <StickyHeader />
  </Story>
</Canvas>

#### Sticky column headers code example

```jsx
import * as React from "react";
import { IcDataTable } from "@ukic/react";
import { IcDataTableColumnObject } from "@ukic/web-components";

// Copy columns array for 'basic' example
const columns: IcDataTableColumnObject[] = [
  {
    key: "firstName",
    title: "First name",
    dataType: "string",
  },
  ...
];

// Copy data array for 'basic' example
const data = [
  {
    firstName: "Joe",
    lastName: "Bloggs",
    age: 30,
    jobTitle: "Developer",
    address: "1 Main Street, Town, County, Postcode",
  },
  ...
];

const DataTable = () => (
  <IcDataTable
    style={{ height: '150px' }}
    caption="Sticky Column Headers"
    columns={columns}
    data={data}
    stickyColumnHeaders
  />
);

export default DataTable;
```

### Row headers

Row headers allow headings to be added to individual rows and styles them as column headings. The column collection includes an additional `header` key which aligns with the row headers. The structure of the `header` column is the same as the columns (i.e. key, title, dataType).
The data array includes an additional `header` key which takes an object. The title of the row header is set by passing `title` as the key and a value.

<Canvas withSource="none">
  <Story name="Row Headers">
    <IcDataTable
      caption="Row Headers"
      columns={ROW_HEADER_COLS}
      data={ROW_HEADER_DATA}
    />
  </Story>
</Canvas>

#### Row headers code example

```jsx
import * as React from "react";
import { IcDataTable } from "@ukic/react";
import { IcDataTableColumnObject } from "@ukic/web-components";

const columns: IcDataTableColumnObject[] = [
  {
    key: 'header',
    title: 'Job Title',
    dataType: 'string'
  },
  {
    key: "firstName",
    title: "First name",
    dataType: "string",
  },
  ...
];

const data = [
  {
    header: { title: 'Employee'},
    firstName: "Joe",
    lastName: "Bloggs",
    age: 30,
    jobTitle: "Developer",
    address: "1 Main Street, Town, County, Postcode",
  },
  ...
];

const DataTable = () => (
  <IcDataTable
    caption="Row Headers"
    columns={columns}
    data={data}
  />
);

export default DataTable;
```

### Sort

Set `sortable` to `true` to set the sort functionality on all columns. Sorting can be set to `unsorted`, `ascending` and `descending` by press the sort buttons next to the column heading.

<Canvas withSource="none">
  <Story name="Sort">
    <IcDataTable caption="Sort" columns={COLS} data={DATA} sortable />
  </Story>
</Canvas>

#### Sort code example

```jsx
import * as React from "react";
import { IcDataTable } from "@ukic/react";
import { IcDataTableColumnObject } from "@ukic/web-components";

// Copy columns array for 'basic' example
const columns: IcDataTableColumnObject[] = [
  {
    key: "firstName",
    title: "First name",
    dataType: "string",
  },
  ...
];

// Copy data array for 'basic' example
const data = [
  {
    firstName: "Joe",
    lastName: "Bloggs",
    age: 30,
    jobTitle: "Developer",
    address: "1 Main Street, Town, County, Postcode",
  },
  ...
];

const DataTable = () => (
  <IcDataTable
    caption="Sort"
    columns={columns}
    data={data}
    sortable
  />
);

export default DataTable;
```

### Sort options

It is possible to change the sort options for the sort buttons. The `sortOptions` prop takes an object with `sortOrders` and `defaultColumn`. `sortOrders` allows the sort order to be amended as we all as remove a sort type. Such as changing the order to `descending`, `unsorted` and remove `ascending`. `defaultColumn` sets which column is ordered by default. This is set by padding the column key as the `defaultColumn` value.

<Canvas withSource="none">
  <Story name="Sort Options">
    <IcDataTable
      caption="Sort Options"
      columns={COLS}
      data={DATA}
      sortable
      sortOptions={{
        sortOrders: ["descending", "unsorted"],
        defaultColumn: "firstName",
      }}
    />
  </Story>
</Canvas>

#### Sort options code example

```jsx
import * as React from "react";
import { IcDataTable } from "@ukic/react";
import { IcDataTableColumnObject } from "@ukic/web-components";

// Copy columns array for 'basic' example
const columns: IcDataTableColumnObject[] = [
  {
    key: "firstName",
    title: "First name",
    dataType: "string",
  },
  ...
];

// Copy data array for 'basic' example
const data = [
  {
    firstName: "Joe",
    lastName: "Bloggs",
    age: 30,
    jobTitle: "Developer",
    address: "1 Main Street, Town, County, Postcode",
  },
  ...
];

const DataTable = () => (
  <IcDataTable
    caption="Sort Options"
    columns={columns}
    data={data}
    sortable
    sortOptions={{
      sortOrders: ["descending", "unsorted"],
      defaultColumn: "firstName",
    }}
  />
);

export default DataTable;
```

### Pagination

Pagination allows large data sets to be split into pages in order to make the data easier to digest. Setting `showPagination` to `true` will add the `IcPagination` component to the bottom of the table. There a several sub components within pagination which are set via the `paginationOptions` prop.

- `itemsPerPage` which allows customization of how many items appear on each page. This requires a collection with `label` and `value` key pairs.
- `itemsPerPageControl` which show or hides the `itemsPerPage` component.
- `goToPageControl` displays controls which allows jumping between pages in a non-linear approach.

<Canvas withSource="none">
  <Story name="Pagination">
    <IcDataTable
      caption="Pagination"
      columns={LONG_COLS}
      data={LONG_DATA}
      showPagination
      paginationOptions={{
        itemsPerPage: [
          { label: "5", value: "5" },
          { label: "10", value: "10" },
          { label: "15", value: "15" },
        ],
        itemsPerPageControl: true,
        goToPageControl: true,
      }}
    />
  </Story>
</Canvas>

#### Pagination code example

```jsx
import * as React from "react";
import { IcDataTable } from "@ukic/react";
import { IcDataTableColumnObject } from "@ukic/web-components";

// Copy columns array for 'basic' example
const columns: IcDataTableColumnObject[] = [
  {
    key: "firstName",
    title: "First name",
    dataType: "string",
  },
  ...
];

// Copy data array for 'basic' example
const data = [
  {
    firstName: "Joe",
    lastName: "Bloggs",
    age: 30,
    jobTitle: "Developer",
    address: "1 Main Street, Town, County, Postcode",
  },
  ...
];

const DataTable = () => (
  <IcDataTable
    caption="Pagination"
    columns={columns}
    data={data}
    showPagination
    paginationOptions={{
      itemsPerPage: [
        { label: "5", value: "5" },
        { label: "10", value: "10" },
        { label: "15", value: "15" },
      ],
      itemsPerPageControl: true,
      goToPageControl: true,
    }}
  />
);

export default DataTable;
```

### Column overrides

There may be a requirement to style a column differently to the rest of the data to add emphasis. For example, centre align data within the 'first name' column. To do this, add `columnAlignment` to the column. `columnAlignment` takes an object which sets the `horizontal` and `vertical` property.

- `horizontal` accepts `left`, `right` or `center`.
- `vertical` accepts `top`, `middle`, `bottom`.

`emphasis` can be added to the column by setting `high` or `low`

<Canvas withSource="none">
  <Story name="Column Overrides">
    <IcDataTable
      caption="Column Overrides"
      columns={COLS_ALIGNMENT}
      data={DATA}
    />
  </Story>
</Canvas>

#### Column overrides code example

```jsx
import * as React from "react";
import { IcDataTable } from "@ukic/react";
import { IcDataTableColumnObject } from "@ukic/web-components";

const columns: IcDataTableColumnObject[] = [
  {
    key: "firstName",
    title: "First name",
    dataType: "string",
    columnAlignment: { horizontal: 'center', vertical: 'middle'},
    emphasis: 'high'
  },
  ...
];

// Copy data array for 'basic' example
const data = [
  {
    firstName: "Joe",
    lastName: "Bloggs",
    age: 30,
    jobTitle: "Developer",
    address: "1 Main Street, Town, County, Postcode",
  },
  ...
];

const DataTable = () => (
  <IcDataTable
    caption="Column overrides"
    columns={columns}
    data={data}
  />
);

export default DataTable;
```

### Row Overrides

Row overrides allow styling to be applied at a row level and is set within the `header` object. The row overrides are used inconjunction with row headers. The following row overrides options apply:

- `rowAlignment` accepts `left`, `right` and `center`.
- `emphasis` accepts `high` or `low`.

<Canvas withSource="none">
  <Story name="Row Overrides">
    <IcDataTable
      caption="Row Overrides"
      columns={ROW_HEADER_COLS}
      data={ROW_ALIGNMENT}
    />
  </Story>
</Canvas>

#### Row overrides code example

```jsx
import * as React from "react";
import { IcDataTable } from "@ukic/react";
import { IcDataTableColumnObject } from "@ukic/web-components";

const columns: IcDataTableColumnObject[] = [
  {
    key: "header",
    title: "Job type",
    dataType: "string",
  },
  {
    key: "firstName",
    title: "First name",
    dataType: "string",
  },
  ...
];

const data = [
  {
    header: {
      title: "Employee",
      rowAlignment: "middle",
      emphasis: "high",
    },
    firstName: "Joe",
    lastName: "Bloggs",
    age: 30,
    jobTitle: "Developer",
    address: "1 Main Street, Town, County, Postcode",
  },
  ...
];

const DataTable = () => (
  <IcDataTable
    caption="Row overrides"
    columns={columns}
    data={data}
  />
);

export default DataTable;
```

### Cell overrides

Cell overrides allows styling to be applied at a cell level. The cell which requires an override accepts an object which requires `data` and can contain `cellAlignment` and/or `emphasis`.

- `data` is the cell value.
- `cellAlignment` accepts an object with the following key pairs:
  - `horizontal` accepts `left`, `right` or `center`.
  - `vertical` accepts `top`, `middle`, `bottom`.
- `emphasis` accepts `high` or `low`.

<Canvas withSource="none">
  <Story name="Cell Overrides">
    <IcDataTable
      caption="Cell Overrides"
      columns={COLS}
      data={DATA_CELL_ALIGNMENT}
    />
  </Story>
</Canvas>

#### Cell overrides code example

```jsx
import * as React from "react";
import { IcDataTable } from "@ukic/react";
import { IcDataTableColumnObject } from "@ukic/web-components";

const columns: IcDataTableColumnObject[] = [
  {
    key: "firstName",
    title: "First name",
    dataType: "string",
  },
  ...
];

const data = [
  {
    firstName: {
      data: "Joe",
      cellAlignment: { horizontal: "center", vertical: "middle" },
      emphasis: "high",
    },
    lastName: "Bloggs",
    age: 30,
    jobTitle: "Developer",
    address: "1 Main Street, Town, County, Postcode",
  },
  ...
];

const DataTable = () => (
  <IcDataTable
    caption="Row overrides"
    columns={columns}
    data={data}
  />
);

export default DataTable;
```
