import {
  Meta,
  Story,
  Canvas,
  ArgsTable,
  Description,
} from "@storybook/addon-docs";
import {
  IcRadioGroup,
  IcRadioOption,
  IcButton,
  IcTextField,
} from "../components";
import radioOptionReadme from "../../../web-components/src/components/ic-radio-option/readme.md";
import radioGroupReadme from "../../../web-components/src/components/ic-radio-group/readme.md";
import { useState, useEffect, useRef } from "react";

<Meta title="Radio button" component={IcRadioGroup} />

<Description markdown={radioOptionReadme + radioGroupReadme} />

### Default

<Canvas>
  <Story name="Default">
    <IcRadioGroup label="This is a label" name="1">
      <IcRadioOption value="valueName1" label="Unselected / Default" />
      <IcRadioOption value="valueName2" label="Selected / Default" selected />
      <IcRadioOption
        value="valueName3"
        label="Unselected / Disabled"
        disabled
      />
    </IcRadioGroup>
  </Story>
</Canvas>

### Horizontal

<Canvas>
  <Story name="Horizontal">
    <IcRadioGroup orientation="horizontal" label="This should be horizontal" name="1">
      <IcRadioOption value="valueName1" label="Selected / Default" selected />
      <IcRadioOption value="valueName2" label="Unselected / Default" />
    </IcRadioGroup>
    <br/>
    <p>Horizontal orientation is overridden with >2 radio options</p>
    <br/>
    <IcRadioGroup orientation="horizontal" label="This should be vertical" name="2">
      <IcRadioOption value="valueNameA" label="First" selected />
      <IcRadioOption value="valueNameB" label="Second" />
      <IcRadioOption value="valueNameC" label="Third" />
    </IcRadioGroup>
  </Story>
</Canvas>

### Required

<Canvas>
  <Story name="Required">
    <IcRadioGroup label="This is a label" required name="1">
      <IcRadioOption value="valueName1" label="Unselected / Default" />
      <IcRadioOption value="valueName2" label="Selected / Default" selected />
      <IcRadioOption
        value="valueName3"
        label="Unselected / Disabled"
        disabled
      />
    </IcRadioGroup>
  </Story>
</Canvas>

### Disabled

<Canvas>
  <Story name="Disabled">
    <IcRadioGroup label="This is a label" name="1">
      <IcRadioOption
        value="valueName1"
        label="Unselected / Disabled 1"
        disabled
      />
      <IcRadioOption
        value="valueName2"
        label="Unselected / Disabled 2"
        disabled
      />
      <IcRadioOption
        value="valueName3"
        label="Unselected / Disabled 3"
        disabled
      />
      <IcRadioOption
        value="valueName4"
        label="Selected / Disabled"
        disabled
        selected
      />
    </IcRadioGroup>
  </Story>
</Canvas>

### Conditional dynamic

<Canvas>
  <Story name="Conditional dynamic" parameters={{ loki: { skip: true } }}>
    <IcRadioGroup
      label="Conditional dynamic"
      name="1"
      onIcChange={(ev) => console.log(ev.detail.selectedOption)}
    >
      <IcRadioOption
        additionalFieldDisplay="dynamic"
        value="valueName1"
        label="option1"
      >
        <IcTextField
          slot="additional-field"
          placeholder="Placeholder"
          label="What's your favourite type of coffee? "
        />
      </IcRadioOption>
      <IcRadioOption
        additionalFieldDisplay="dynamic"
        value="valueName2"
        label="option2 - error example"
      >
        <IcTextField
          validationStatus="error"
          validationText="Now it has really gone to (coffee) pot"
          slot="additional-field"
          placeholder="Placeholder"
          label="What's your favourite type of coffee? "
        />
      </IcRadioOption>
      <IcRadioOption
        additionalFieldDisplay="dynamic"
        value="valueName3"
        label="option3"
      >
        <IcTextField
          slot="additional-field"
          placeholder="Placeholder"
          label="What's your favourite type of coffee? "
        />
      </IcRadioOption>
    </IcRadioGroup>
  </Story>
</Canvas>

### Conditional static

<Canvas>
  <Story name="Conditional static" parameters={{ loki: { skip: true } }}>
    <IcRadioGroup label="Conditional dynamic" name="1">
      <IcRadioOption value="valueName1" label="option1">
        <IcTextField
          slot="additional-field"
          label="What's your favourite type of coffee?"
        />
      </IcRadioOption>
      <IcRadioOption value="valueName2" label="option2" />
    </IcRadioGroup>
  </Story>
</Canvas>

### Helper text

<Canvas>
  <Story name="Helper text">
    <IcRadioGroup label="This is a label" name="1" helperText="Helper text">
      <IcRadioOption value="valueName1" label="Unselected / Default" />
      <IcRadioOption value="valueName2" label="Selected / Default" selected />
      <IcRadioOption
        value="valueName3"
        label="Unselected / Disabled"
        disabled
      />
    </IcRadioGroup>
  </Story>
</Canvas>

### Size small

<Canvas>
  <Story name="Size small">
    <IcRadioGroup label="This is a label" name="1" size="small">
      <IcRadioOption value="valueName1" label="Unselected / Default" />
      <IcRadioOption value="valueName2" label="Selected / Default" selected />
      <IcRadioOption
        value="valueName3"
        label="Unselected / Disabled"
        disabled
      />
    </IcRadioGroup>
  </Story>
</Canvas>

### Validation

<Canvas>
  <Story name="Validation">
    <IcRadioGroup
      label="This is a label"
      name="1"
      validationStatus="error"
      validationText="Error message"
    >
      <IcRadioOption value="valueName1" label="Unselected / Default" />
      <IcRadioOption value="valueName2" label="Selected / Default" selected />
      <IcRadioOption
        value="valueName3"
        label="Unselected / Disabled"
        disabled
      />
    </IcRadioGroup>
  </Story>
</Canvas>

### Form - This shows how the radio button works within a form and is where the value of the radio button selected will appear in the console.log

export const Form = () => {
  const handleSubmit = (ev) => {
    ev.preventDefault();
    console.log(
      "Form value: ",
      document.querySelector("input[name='1']").value
    );
  };
  return (
    <form onSubmit={(ev) => handleSubmit(ev)}>
      <IcRadioGroup label="This is a label" name="1">
        <IcRadioOption value="valueName1" label="Unselected / Default" />
        <IcRadioOption value="valueName2" label="Selected / Default" />
        <IcRadioOption
          value="valueName3"
          label="Unselected / Disabled"
          disabled
        />
      </IcRadioGroup>
      <input type="submit" value="Submit" />
      <input type="reset" value="Reset" />
    </form>
  );
};

<Canvas>
  <Story name="Form" parameters={{ loki: { skip: true } }}>
    <Form />
  </Story>
</Canvas>

### Dynamic loading

export const RadioOptionsDynamic = () => {
  const [radioOptions, setRadioOptions] = useState([]);
   
  useEffect(() => {
    setTimeout(() => {
      setRadioOptions([
        { label: 'Item 1', value: 'Item 1'},
        { label: 'Item 2', value: 'Item 2'},
        { label: 'Item 3', value: 'Item 3'},
        { label: 'Item 4', value: 'Item 4'},
      ])
    }, 3000)
  }, [])

return (

<IcRadioGroup label="What is your favourite coffee?" name="radio-group-1">
  {radioOptions.map((option, index) => (
    <IcRadioOption
      key={index + option.value}
      value={option.value}
      label={option.label}
    />
  ))}
</IcRadioGroup>
) }

<Canvas>
  <Story name="Dynamic loading">
    <RadioOptionsDynamic />
  </Story>
</Canvas>

### Updating options

export const RadioOptionsUpdate = () => {
  const [radioOptions, setRadioOptions] = useState([
    { label: "Item 1", value: "Item 1" },
    { label: "Item 2", value: "Item 2" },
    { label: "Item 3", value: "Item 3" },
    { label: "Item 4", value: "Item 4" },
  ]);

const updateRadios = () => {
setRadioOptions([
{ label: "Item 5", value: "Item 5" },
{ label: "Item 6", value: "Item 6" },
]);
};

return (

<>
  <IcRadioGroup label="What is your favourite coffee?" name="radio-group-1">
    {radioOptions.map((option, index) => (
      <IcRadioOption
        key={index + option.value}
        value={option.value}
        label={option.label}
      />
    ))}
  </IcRadioGroup>
  <br />
  <IcButton onClick={updateRadios}>Update</IcButton>
</>
); };

<Canvas>
  <Story name="Updating options">
    <RadioOptionsUpdate />
  </Story>
</Canvas>

### Controlled

export const Controlled = () => {
  const [selected, setSelected] = useState(true);
  const defaultButtonClickHandler = () => {
    setSelected(false);
  };
  const differentButtonClickHandler = () => {
    setSelected(true);
  };
  return (
    <>
      <IcRadioOption selected={selected} label="Label" value="valueName1" />
      <IcButton variant="primary" onClick={defaultButtonClickHandler}>
        Unselected
      </IcButton>
      <IcButton variant="primary" onClick={differentButtonClickHandler}>
        Selected
      </IcButton>
    </>
  );
};

<Canvas>
  <Story name="Controlled">
    <Controlled />
  </Story>
</Canvas>

### Uncontrolled

export const Uncontrolled = () => {
  const radioEl = useRef();
  const handleCheck = () => {
    console.log(radioEl.current.selected);
  };
  return (
    <IcRadioGroup label="This is a label" name="1">
      <IcRadioOption
        ref={radioEl}
        value="valueName1"
        label="Unselected / Default"
        onIcSelectedChange={handleCheck}
      />
      <IcRadioOption value="valueName2" label="Selected / Default" selected />
    </IcRadioGroup>
  );
};

<Canvas>
  <Story name="Uncontrolled">
    <Uncontrolled />
  </Story>
</Canvas>

### Additional field rendering

export const RadioOptionsAdditional = () => {
  const [showAdditional, setShowAdditional] = useState(false);
  const changeDisplay = () => {
    setShowAdditional(!showAdditional);
  }
  return (
    <>
    <IcRadioGroup label='What is your favourite coffee?' name='radio-group-1'>
      <IcRadioOption value='Item 1' label='Item 1' />
      <IcRadioOption value='Item 2' label='Item 2 - has conditional field'
        additionalFieldDisplay={showAdditional ? "dynamic" : "static"}
      >
        {showAdditional && (<IcTextField
          slot='additional-field'
          placeholder='Placeholder'
          label='What is your favourite coffee?'
        />)}
      </IcRadioOption>
      <IcRadioOption value='Item 3' label='Item 3' />
      <IcRadioOption value='Item 4' label='Item 4' />
    </IcRadioGroup>
    <br />
    <IcButton onClick={changeDisplay}>Toggle additional</IcButton>
    </>
  )
}

<Canvas>
  <Story name="Additional field rendering">
    <RadioOptionsAdditional />
  </Story>
</Canvas>

### Playground

export const defaultArgs = {
  disabled: false,
  helperText: "Some helper text",
  hideLabel: false,
  label: "This is a label",
  name: "1",
  orientation: "vertical",
  required: false,
  size: "default",
  validationStatus: "",
  validationText: "",
  additionalFieldDisplay: "static",
  radioDisabled: false,
  dynamicText: "This selection requires additional answers",
  radioLabel: "Radio 1",
  radioName: "radio1",
  value: "valueName1",
  selected: false,
  additionalFieldSlot: true
};

<Canvas>
  <Story
    args={defaultArgs}
    parameters={{ loki: { skip: true } }}
    argTypes={{
      orientation: {
        options: [
          "vertical", "horizontal"
        ],
        control: {
          type: "inline-radio",
        },
      },
      size: {
        options: [
          "default", "small"
        ],
        control: {
          type: "inline-radio",
        },
      },
      validationStatus: {
        options: [
          "error", "warning", "success", ""
        ],
        control: {
          type: "radio",
        },
      },
      additionalFieldDisplay: {
        options: [
          "static", "dynamic"
        ],
        control: {
          type: "inline-radio",
        },
      },
      additionalFieldSlot: {
        mapping: {
          true: "additional-field",
          false: "",
        },
      },
    }}
    name="Playground"
  >
    {(args) =>
      (
        <IcRadioGroup
          label={args.label}
          name={args.name}
          orientation={args.orientation}
          required={args.required}
          size={args.size}
          validationStatus={args.validationStatus}
          validationText={args.validationText}
          helperText={args.helperText}
          disabled={args.disabled}
          hideLabel={args.hideLabel}
        >
          <IcRadioOption
            additionalFieldDisplay={args.additionalFieldDisplay}
            value={args.value}
            label={args.radioLabel}
            name={args.radioName}
            selected={args.selected}
            disabled={args.radioDisabled}
            dynamicText={args.dynamicText}
          >
            <IcTextField
              slot={args.additionalFieldSlot}
              placeholder="Placeholder"
              label="What's your favourite type of coffee?"
            />
          </IcRadioOption>
          <IcRadioOption
            value="valueName2"
            label="Radio 2"
          />
        </IcRadioGroup>
      )
    }
  </Story>
</Canvas>